# AIエージェント開発・生成プラットフォーム アーキテクチャ提案書

## 1. 目的と基本方針

### 1.1. 目的
本プロジェクトの最終目的は、ユーザーの指示に基づき、自律的に動作する新しいAIエージェントを自動で設計、開発、デプロイする**「Creator Agent（AIエージェントを創り出すAIエージェント）」**を構築することにある。

### 1.2. 基本方針
容量や物理的な場所に縛られず、スケーラブルで持続可能な開発を実現するため、以下の基本方針を採用する。

- **サーバーレス・ファースト:** サーバーの管理を不要にし、開発とビジネスロジックに集中する。
- **フルマネージドサービスの活用:** データベース、AIモデル、コンテナ実行環境など、専門的な運用をGoogle Cloudに委任する。
- **Infrastructure as Code (IaC):** Terraformを用いて、インフラ構成をコードで管理し、AIエージェントの自動生成基盤を確立する。

---

## 2. 推奨アーキテクチャ

Creator Agent、およびそれが生成するAIエージェントは、以下の4つの機能要素で構成される。

### 2.1. AIエージェントの「頭脳」 (The Brain) - 思考と計画
- **役割:** 意思決定、推論、計画、コード生成など、エージェントの知的活動を担う。
- **推奨サービス:**
    - **`Vertex AI (Gemini API)`:** エージェントの思考エンジン。自然言語理解、計画立案、コード生成能力を提供する。
    - **`Cloud Run` / `Cloud Functions`:** 思考プロセスを制御するロジック（神経系）を実行する。ユーザー入力を受け、Vertex AIを呼び出し、結果を解釈して次の行動を決定する。

### 2.2. AIエージェントの「実行・身体」 (The Body) - タスクの実行
- **役割:** 頭脳が決定したタスク（ツール利用）を実行し、外部世界と相互作用する。
- **推奨サービス:**
    - **`Cloud Run` / `Cloud Functions`:** 「外部APIを叩く」「Webをスクレイピングする」といった個別のツールを実装する。
    - **`Cloud Tasks`:** 動画の要約など、時間のかかる非同期タスクをキューイングし、バックグラウンドで処理する。

### 2.3. AIエージェントの「記憶」 (The Memory) - 知識と状態の保存
- **役割:** 対話履歴、学習した知識、自己の状態などを永続的に保存する。
- **推奨サービス:**
    - **`Firestore`:** 短期・中期記憶。対話履歴やタスクの状態など、構造化データを高速に読み書きする。
    - **`Vertex AI Vector Search`:** 長期的な知識・概念記憶。ドキュメントをベクトル化し、意味に基づいた高速な検索（RAG）を実現する。
    - **`Cloud Storage`:** 生成したファイルやログなど、非構造化データを安価に保存する。

---

## 3. 開発・CI/CD・実行環境

### 3.1. 開発環境: Cloud Workstations
- **役割:** 開発者がコードを書くための、安定したクラウドベースの開発環境。
- **選定理由:** Cloud Shellで発生したような不可解なネットワーク問題やディスク容量制限から解放される。Android Studioのような重いツールも不要になり、React/NestJS開発に最適化された環境を永続的に利用できる。

### 3.2. CI/CD（自動化）: Cloud Build & Artifact Registry
- **役割:** ソースコードの変更をトリガーに、ビルド、テスト、コンテナ化、デプロイを自動で実行する。
- **ワークフロー:**
    1.  コードをリポジトリにプッシュ。
    2.  `Cloud Build` がビルドを開始。
    3.  完成したコンテナイメージを `Artifact Registry` に保管。
    4.  `Cloud Build` が `Cloud Run` に新しいバージョンを自動デプロイ。

### 3.3. インフラのコード管理: Terraform
- **役割:** 新しいAIエージェントが必要とするGoogle Cloudのリソース群（Cloud Runサービス、Firestoreなど）の構成をコードで記述する。
- **選定理由:** Creator AgentがこのTerraformコードを**自動生成**し、Cloud Build経由で実行することで、**インフラ構築も含めた完全なAIエージェントの自動生成**を実現する。

### 3.4. 本番実行環境: Cloud Run & Cloud Functions
- **役割:** Creator Agent、およびそれが生成したすべてのAIエージェントが実際に稼働する場所。
- **選定理由:** サーバーレスであるため、アクセスがない時のコストはほぼゼロ。トラフィックに応じて自動でスケールし、個々のエージェントが独立して動作できる。

---

## 4. 次のステップ

1.  **Cloud Workstations 環境のセットアップ:** 本格的な開発に着手するための、安定した開発環境を構築する。
2.  **フロントエンドとバックエンドの雛形を再構築:** Cloud Workstations上で、今回のトラブルシューティングで確立したReact + NestJSの構成を再構築し、正常に通信できることを確認する。
